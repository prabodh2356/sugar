import java.util.*;

class StudentNode {
    int rollNo;
    String name;
    int marks;
    StudentNode next;

    public StudentNode(int rollNo, String name, int marks) {
        this.rollNo = rollNo;
        this.name = name;
        this.marks = marks;
        this.next = null;
    }
}

class StudentLinkedList {
    private StudentNode head;

    // Add student record
    public void addStudent(int rollNo, String name, int marks) {
        StudentNode newNode = new StudentNode(rollNo, name, marks);
        if (head == null) {
            head = newNode;
        } else {
            StudentNode current = head;
            while (current.next != null) {
                current = current.next;
            }
            current.next = newNode;
        }
        System.out.println("‚úÖ Student record added.");
    }

    // Delete student by roll number
    public void deleteStudent(int rollNo) {
        StudentNode current = head;
        StudentNode prev = null;

        while (current != null) {
            if (current.rollNo == rollNo) {
                if (prev != null) {
                    prev.next = current.next;
                } else {
                    head = current.next;
                }
                System.out.println("‚úÖ Student record deleted.");
                return;
            }
            prev = current;
            current = current.next;
        }
        System.out.println("‚ö†Ô∏è Student not found.");
    }

    // Update student record
    public void updateStudent(int rollNo, String newName, int newMarks) {
        StudentNode current = head;
        while (current != null) {
            if (current.rollNo == rollNo) {
                current.name = newName;
                current.marks = newMarks;
                System.out.println("‚úÖ Student record updated.");
                return;
            }
            current = current.next;
        }
        System.out.println("‚ö†Ô∏è Student not found.");
    }

    // Search student
    public void searchStudent(int rollNo) {
        StudentNode current = head;
        while (current != null) {
            if (current.rollNo == rollNo) {
                System.out.println("üîç Found: Roll No: " + current.rollNo + ", Name: " + current.name + ", Marks: " + current.marks);
                return;
            }
            current = current.next;
        }
        System.out.println("‚ö†Ô∏è Student not found.");
    }

    // Display all students (sorted by rollNo or marks)
    public void displayStudents(String sortBy, boolean ascending) {
        List<StudentNode> students = new ArrayList<>();
        StudentNode current = head;

        while (current != null) {
            students.add(current);
            current = current.next;
        }

        if (students.isEmpty()) {
            System.out.println("‚ö†Ô∏è No records to display.");
            return;
        }

        Comparator<StudentNode> comparator;
        if (sortBy.equalsIgnoreCase("marks")) {
            comparator = Comparator.comparingInt(s -> s.marks);
        } else {
            comparator = Comparator.comparingInt(s -> s.rollNo);
        }

        if (!ascending) {
            comparator = comparator.reversed();
        }

        students.sort(comparator);

        System.out.println("\nüìã Student Records:");
        for (StudentNode s : students) {
            System.out.println("Roll No: " + s.rollNo + ", Name: " + s.name + ", Marks: " + s.marks);
        }
    }
}

public class StudentRecordManagement {
    public static void main(String[] args) {
        Scanner sc = new Scanner(System.in);
        StudentLinkedList system = new StudentLinkedList();

        while (true) {
            System.out.println("\n--- Student Record Management Menu ---");
            System.out.println("1. Add Student");
            System.out.println("2. Delete Student");
            System.out.println("3. Update Student");
            System.out.println("4. Search Student");
            System.out.println("5. Display All Students");
            System.out.println("6. Exit");
            System.out.print("Enter your choice (1-6): ");

            // Validate choice input
            if (!sc.hasNextInt()) {
                System.out.println("‚ùå Invalid input. Please enter a number between 1 and 6.");
                sc.nextLine(); // clear invalid input
                continue;
            }

            int choice = sc.nextInt();
            sc.nextLine(); // clear buffer

            switch (choice) {
                case 1:
                    System.out.print("Enter Roll No: ");
                    int roll = sc.nextInt();
                    sc.nextLine(); // clear buffer
                    System.out.print("Enter Name: ");
                    String name = sc.nextLine();
                    System.out.print("Enter Marks: ");
                    int marks = sc.nextInt();
                    system.addStudent(roll, name, marks);
                    break;

                case 2:
                    System.out.print("Enter Roll No to Delete: ");
                    int rollDel = sc.nextInt();
                    system.deleteStudent(rollDel);
                    break;

                case 3:
                    System.out.print("Enter Roll No to Update: ");
                    int rollUp = sc.nextInt();
                    sc.nextLine(); // clear buffer
                    System.out.print("Enter New Name: ");
                    String newName = sc.nextLine();
                    System.out.print("Enter New Marks: ");
                    int newMarks = sc.nextInt();
                    system.updateStudent(rollUp, newName, newMarks);
                    break;

                case 4:
                    System.out.print("Enter Roll No to Search: ");
                    int rollSearch = sc.nextInt();
                    system.searchStudent(rollSearch);
                    break;

                case 5:
                    System.out.print("Sort by 'roll_no' or 'marks': ");
                    String sortBy = sc.nextLine();
                    System.out.print("Order 'asc' or 'desc': ");
                    String order = sc.nextLine();
                    boolean ascending = order.equalsIgnoreCase("asc");
                    system.displayStudents(sortBy, ascending);
                    break;

                case 6:
                    System.out.println("üëã Exiting Student Record Management System.");
                    sc.close();
                    return;

                default:
                    System.out.println("‚ùå Invalid choice. Try again.");
            }
        }
    }
}
